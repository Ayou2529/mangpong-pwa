# สรุปไฟล์ที่สร้างและอัปเดต

## ไฟล์ที่สร้างใหม่:

1. **edit.html** - หน้าเว็บสำหรับแก้ไขงาน
2. **main_edit.js** - ไฟล์ JavaScript หลักที่มีฟังก์ชันการแก้ไขงาน
3. **gas_edit.js** - โค้ด Google Apps Script ที่มีฟังก์ชันการจัดการงาน
4. **edit.js** - ไฟล์ JavaScript สำหรับจัดการหน้าแก้ไขงาน
5. **index_with_edit.html** - ไฟล์ index.html ที่มีการอัปเดตเพื่อรองรับการแก้ไขงาน

## ฟังก์ชันที่เพิ่มใน frontend (main_edit.js):

1. **loadJobForEdit(jobId)** - โหลดข้อมูลงานจาก backend เพื่อแก้ไข
2. **populateEditFormWithJobData(job)** - แสดงข้อมูลงานในแบบฟอร์มแก้ไข
3. **updateJob()** - อัปเดตงานที่มีอยู่ในระบบ
4. **collectEditFormData()** - รวบรวมข้อมูลจากแบบฟอร์มแก้ไข
5. **resetEditForm()** - รีเซ็ตแบบฟอร์มแก้ไข

## ฟังก์ชันที่เพิ่มใน backend (gas_edit.js):

1. **handleCreateJob(p)** - สร้างงานใหม่
   - ตั้ง timestamp เป็นเวลาปัจจุบัน
   - ตั้ง jobDate จาก params.jobDate หรือเวลาปัจจุบันถ้าไม่มี
   - เพิ่มแถวใหม่ในชีต Jobs
   - คืนค่า { success:true, jobId }

2. **handleUpdateJob(p)** - อัปเดตงานที่มีอยู่
   - ค้นหาแถวที่ jobId ตรงกัน
   - รักษา timestamp เดิมไว้ (ไม่เปลี่ยนเวลาที่บันทึกจริง)
   - อัปเดตข้อมูลฟิลด์อื่น ๆ รวมถึง jobDate
   - ใช้ setValues เพื่ออัปเดตแถวแทนการเพิ่มแถวใหม่
   - คืนค่า { success:true, jobId }

3. **handleGetJobById(p)** - ดึงข้อมูลงานตาม jobId
   - ค้นหาแถวที่ jobId ตรงกัน
   - คืนค่าข้อมูลทั้งหมดเป็น object { header: value }
   - คืนค่า { success:true, job }

## การใช้งาน:

1. สำหรับสร้างงานใหม่:
   - ไปที่ index.html
   - คลิก "งานใหม่"
   - กรอกข้อมูลในแบบฟอร์ม
   - คลิก "บันทึกงาน"

2. สำหรับแก้ไขงาน:
   - ไปที่ index.html
   - คลิก "ประวัติ"
   - คลิก "แก้ไขงาน" หรือ "แก้ไขร่าง" หรือ "แก้ไขงานไม่สมบูรณ์"
   - จะถูกนำไปที่ edit.html?jobId=xxxx
   - แบบฟอร์มจะถูกเติมข้อมูลอัตโนมัติ
   - แก้ไขข้อมูลในแบบฟอร์ม
   - คลิก "บันทึกการแก้ไข"

## คุณสมบัติเพิ่มเติม:

1. แบบฟอร์มใช้หน้าเดียวทั้งสำหรับสร้างและแก้ไขงาน
2. ใช้ query string เพื่อแยกโหมด:
   - index.html - หน้าหลัก
   - edit.html?jobId=xxxx - หน้าแก้ไขงาน
3. รักษา timestamp เดิมเมื่อแก้ไขงาน (เวลาที่บันทึกจริง)
4. สามารถแก้ไข jobDate ได้ (สามารถแก้ย้อนหลังได้)
5. แบบฟอร์มเหมือนกันทั้งโหมดสร้างและแก้ไข