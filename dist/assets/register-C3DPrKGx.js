import{b as E,E as f,s as g,a as c}from"./errors-D2UT2t2I.js";import"./main-CExweLId.js";async function R(){const n=document.getElementById("register-username"),o=document.getElementById("register-password"),s=document.getElementById("register-confirm-password"),i=document.getElementById("register-fullname"),a=document.getElementById("register-phone"),l=document.getElementById("register-email");if(!n||!o||!s||!i||!a||!l)return await Swal.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่พบองค์ประกอบฟอร์มที่จำเป็น",confirmButtonText:"ตกลง",confirmButtonColor:"#ef4444"}),null;const t=n.value.trim(),r=o.value.trim(),e=s.value.trim(),u=i.value.trim(),m=a.value.trim(),d=l.value.trim(),w=E({username:t,password:r,confirmPassword:e,fullName:u,phone:m,email:d});return w.isValid?{username:t,password:r,fullName:u,phone:m,email:d}:(await Swal.fire({icon:"warning",title:"กรุณากรอกข้อมูลให้ครบ",text:w.errors.join(`
`),confirmButtonText:"ตกลง",confirmButtonColor:"#f59e0b"}),null)}async function p(n){const{username:o,password:s,fullName:i,phone:a,email:l}=n;Swal.fire({title:"กำลังสมัครสมาชิก...",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{Swal.showLoading()}});try{const t=new Promise((u,m)=>setTimeout(()=>m(new Error(f.TIMEOUT_ERROR)),2e4)),r=g({action:"register",username:o,password:s,fullName:i,phone:a,email:l}),e=await Promise.race([r,t]);e&&e.success?(await Swal.fire({icon:"success",title:"สมัครสมาชิกสำเร็จ!",text:"คุณสามารถเข้าสู่ระบบได้แล้ว",confirmButtonText:"ตกลง",confirmButtonColor:"#10b981"}),document.getElementById("register-form").reset(),showPage("login-screen")):await Swal.fire({icon:"error",title:c.REGISTER_ERROR,text:e&&e.error?e.error:f.REGISTER_FAILED,confirmButtonText:"ตกลง",confirmButtonColor:"#ef4444"})}catch(t){console.error("Registration error:",t);let r=c.CONNECTION_FAILED,e=f.NETWORK_ERROR;t.message&&t.message.includes("หมดเวลา")?(r=c.TIMEOUT,e="การเชื่อมต่อกับเซิร์ฟเวอร์ใช้เวลานานเกินไป โปรดตรวจสอบการเชื่อมต่ออินเทอร์เน็ตของคุณ"):t.message&&t.message.includes("ไม่สามารถเชื่อมต่อ")&&(r=c.CONNECTION_FAILED,e="ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้ โปรดตรวจสอบการเชื่อมต่ออินเทอร์เน็ตของคุณ"),await Swal.fire({icon:"error",title:r,text:e,confirmButtonText:"ตกลง",confirmButtonColor:"#ef4444"})}}async function T(n){n.preventDefault();const o=await R();o&&await p(o)}export{T as handleRegister};
